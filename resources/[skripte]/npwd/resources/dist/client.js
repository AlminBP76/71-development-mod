(()=>{var Fe=Object.create;var w=Object.defineProperty;var Ge=Object.getOwnPropertyDescriptor;var ve=Object.getOwnPropertyNames,ee=Object.getOwnPropertySymbols,He=Object.getPrototypeOf,te=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var ne=(t,e,n)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,B=(t,e)=>{for(var n in e||(e={}))te.call(e,n)&&ne(t,n,e[n]);if(ee)for(var n of ee(e))Ue.call(e,n)&&ne(t,n,e[n]);return t};var Be=t=>w(t,"__esModule",{value:!0});var a=(t,e)=>()=>(t&&(e=t(t=0)),e);var re=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ke=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ve(e))!te.call(t,s)&&(n||s!=="default")&&w(t,s,{get:()=>e[s],enumerable:!(r=Ge(e,s))||r.enumerable});return t},ie=(t,e)=>ke(Be(w(t!=null?Fe(He(t)):{},"default",!e&&t&&t.__esModule?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var o=(t,e,n)=>new Promise((r,s)=>{var A=T=>{try{u(n.next(T))}catch(P){s(P)}},D=T=>{try{u(n.throw(T))}catch(P){s(P)}},u=T=>T.done?r(T.value):Promise.resolve(T.value).then(A,D);u((n=n.apply(t,e)).next())});var c,oe,O=a(()=>{c=t=>new Promise(e=>setTimeout(e,t)),oe=()=>{let t="";for(let e=0;e<32;e+=1)switch(e){case 8:case 20:t+="-",t+=(Math.random()*16|0).toString(16);break;case 12:t+="-",t+="4";break;case 16:t+="-",t+=(Math.random()*4|8).toString(16);break;default:t+=(Math.random()*16|0).toString(16)}return t}});var x,m,Ve,i,g,d=a(()=>{O();y();x=class{constructor(e){this._defaultSettings={promiseTimeout:15e3};this.setSettings(e)}setSettings(e){this._settings=B(B({},this._defaultSettings),e)}emitNetPromise(e,...n){return new Promise((r,s)=>{let A=!1;setTimeout(()=>{A=!0,s(`${e} has timed out after ${this._settings.promiseTimeout} ms`)},this._settings.promiseTimeout);let D=oe(),u=`${e}:${D}`;emitNet(e,u,...n);let T=P=>{removeEventListener(u,T),!A&&r(P)};onNet(u,T)})}},m=(t,e)=>{RegisterNuiCallbackType(t),on(`__cfx_nui:${t}`,e)},Ve=()=>new Promise(t=>{let e=setInterval(()=>{global.isPlayerLoaded&&t(e)},50)}).then(t=>clearInterval(t)),i=t=>{RegisterNuiCallbackType(t),on(`__cfx_nui:${t}`,(e,n)=>o(void 0,null,function*(){global.isPlayerLoaded||(yield Ve());try{let r=yield f.emitNetPromise(t,e);n(r)}catch(r){console.error("Error encountered while listening to resp. Error:",r),n({status:"error"})}}))},g=(t,e,n)=>{let r=typeof e;if(!n.includes(r))throw new Error(`Export ${t} was called with incorrect argument type (${n.join(", ")}. Passed: ${e}, Type: ${r})`)}});var E,M=a(()=>{E=JSON.parse(LoadResourceFile(GetCurrentResourceName(),"config.json"))});var N,ae=a(()=>{N={TWITTER:"TWITTER",MATCH:"MATCH",MESSAGES:"MESSAGES",NOTES:"NOTES",MARKETPLACE:"MARKETPLACE",CONTACTS:"CONTACTS",CAMERA:"CAMERA"}});function l(t,e,n){return SendNUIMessage({app:t,method:e,data:n})}function se(t,e={}){return l(N.TWITTER,t,e)}function F(t,e={}){return l(N.MESSAGES,t,e)}function le(t,e={}){return l(N.NOTES,t,e)}function k(t,e={}){l(N.MARKETPLACE,t,e)}function Ee(t,e={}){l(N.CONTACTS,t,e)}function pe(t,e={}){l(N.CAMERA,t,e)}var I=a(()=>{ae()});var G=a(()=>{});function L(){h!=0&&(DeleteEntity(h),h=0,v=!1)}var h,v,V,de,W=a(()=>{O();h=0,v=!1,V="prop_amb_phone",de=()=>o(void 0,null,function*(){if(L(),v)v&&console.log("prop already created");else{for(RequestModel(V);!HasModelLoaded(V);)yield c(1);let t=PlayerPedId(),[e,n,r]=GetEntityCoords(t,!0);h=CreateObject(GetHashKey(V),e,n,r+.2,!0,!0,!0);let s=GetPedBoneIndex(t,28422);AttachEntityToEntity(h,t,s,0,0,0,0,0,-0,!0,!0,!1,!0,1,!0),v=!0}})});var K,me=a(()=>{W();O();K=class{constructor(){this.onCall=!1;this.phoneOpen=!1;this.onCamera=!1}createAnimationInterval(){this.animationInterval=setInterval(()=>o(this,null,function*(){let e=PlayerPedId();this.onCall?this.handleCallAnimation(e):this.phoneOpen&&!this.onCamera&&this.handleOpenAnimation(e)}),250)}setPhoneState(e,n){switch(e){case 0:this.onCall=n;break;case 1:this.phoneOpen=n;break;case 2:this.onCamera=n;break}!this.onCall&&!this.phoneOpen?this.animationInterval&&(clearInterval(this.animationInterval),this.animationInterval=null):this.animationInterval||this.createAnimationInterval()}handleCallAnimation(e){IsPedInAnyVehicle(e,!0)?this.handleOnCallInVehicle(e):this.handleOnCallNormal(e)}handleOpenAnimation(e){IsPedInAnyVehicle(e,!0)?this.handleOpenVehicleAnim(e):this.handleOpenNormalAnim(e)}handleCallEndAnimation(e){IsPedInAnyVehicle(e,!0)?this.handleCallEndVehicleAnim(e):this.handleCallEndNormalAnim(e)}handleCloseAnimation(e){IsPedInAnyVehicle(e,!0)?this.handleCloseVehicleAnim(e):this.handleCloseNormalAnim(e)}openPhone(){return o(this,null,function*(){de(),this.onCall||this.handleOpenAnimation(PlayerPedId()),this.setPhoneState(1,!0)})}closePhone(){return o(this,null,function*(){L(),this.setPhoneState(1,!1),this.onCall||this.handleCloseAnimation(PlayerPedId())})}startPhoneCall(){return o(this,null,function*(){this.handleCallAnimation(PlayerPedId()),this.setPhoneState(0,!0)})}endPhoneCall(){return o(this,null,function*(){this.handleCallEndAnimation(PlayerPedId()),this.setPhoneState(0,!1)})}openCamera(){return o(this,null,function*(){this.setPhoneState(2,!0)})}closeCamera(){return o(this,null,function*(){this.setPhoneState(2,!1)})}loadAnimDict(e){return o(this,null,function*(){for(RequestAnimDict(e);!HasAnimDictLoaded(e);)yield c(100)})}handleOpenVehicleAnim(e){return o(this,null,function*(){let n="anim@cellphone@in_car@ps",r="cellphone_text_in";yield this.loadAnimDict(n),IsEntityPlayingAnim(e,n,r,3)||(SetCurrentPedWeapon(e,2725352035,!0),TaskPlayAnim(e,n,r,7,-1,-1,50,0,!1,!1,!1))})}handleOpenNormalAnim(e){return o(this,null,function*(){let n="cellphone@",r="cellphone_text_in";yield this.loadAnimDict(n),IsEntityPlayingAnim(e,n,r,3)||(SetCurrentPedWeapon(e,2725352035,!0),TaskPlayAnim(e,n,r,8,-1,-1,50,0,!1,!1,!1))})}handleCloseVehicleAnim(e){return o(this,null,function*(){let n="anim@cellphone@in_car@ps";StopAnimTask(e,n,"cellphone_text_in",1),StopAnimTask(e,n,"cellphone_call_to_text",1),L()})}handleCloseNormalAnim(e){return o(this,null,function*(){let n="cellphone@",r="cellphone_text_out";StopAnimTask(e,n,"cellphone_text_in",1),yield c(100),yield this.loadAnimDict(n),TaskPlayAnim(e,n,r,7,-1,-1,50,0,!1,!1,!1),yield c(200),StopAnimTask(e,n,r,1),L()})}handleOnCallInVehicle(e){return o(this,null,function*(){let n="anim@cellphone@in_car@ps",r="cellphone_call_listen_base";IsEntityPlayingAnim(e,n,r,3)||(yield this.loadAnimDict(n),TaskPlayAnim(e,n,r,3,3,-1,49,0,!1,!1,!1))})}handleOnCallNormal(e){return o(this,null,function*(){let n="cellphone@",r="cellphone_call_listen_base";IsEntityPlayingAnim(e,n,r,3)||(yield this.loadAnimDict(n),TaskPlayAnim(e,n,r,3,3,-1,49,0,!1,!1,!1))})}handleCallEndVehicleAnim(e){return o(this,null,function*(){let n="anim@cellphone@in_car@ps",r="cellphone_call_to_text";StopAnimTask(e,n,"cellphone_call_listen_base",1),yield this.loadAnimDict(n),TaskPlayAnim(e,n,r,1.3,5,-1,50,0,!1,!1,!1)})}handleCallEndNormalAnim(e){return o(this,null,function*(){let n="cellphone@",r="cellphone_call_to_text";IsEntityPlayingAnim(e,"cellphone@","cellphone_call_listen_base",49)&&(yield this.loadAnimDict(n),TaskPlayAnim(e,n,r,2.5,8,-1,50,0,!1,!1,!1))})}}});var p,H=a(()=>{me();p=new K});function $e(){return o(this,null,function*(){if(!(E.PhoneAsItem.enabled&&!(yield Ye()))){if(global.isPhoneOpen)return yield b();yield Y()}})}var We,Ke,Y,b,Ye,$=a(()=>{I();G();M();H();d();global.isPhoneOpen=!1;global.isPhoneDisabled=!1;global.isPlayerLoaded=!1;We=global.exports;onNet("npwd:setPlayerLoaded",t=>{global.isPlayerLoaded=t,t||l("PHONE","npwd:unloadCharacter",{})});RegisterKeyMapping(E.general.toggleCommand,"Toggle Phone","keyboard",E.general.toggleKey);setTimeout(()=>{emit("chat:addSuggestion",`${E.general.toggleCommand}`,"Toggle displaying your cellphone")},1e3);Ke=()=>{let t=GetClockHours(),e=GetClockMinutes();return t<10&&(t=`0${t}`),e<10&&(e=`0${e}`),`${t}:${e}`},Y=()=>o(void 0,null,function*(){global.isPhoneOpen=!0;let t=Ke();yield p.openPhone(),emitNet("npwd:getCredentials"),SetCursorLocation(.9,.922),l("PHONE","npwd:setVisibility",!0),l("PHONE","npwd:setGameTime",t),SetNuiFocus(!0,!0),SetNuiFocusKeepInput(!0),emit("npwd:disableControlActions",!0)}),b=()=>o(void 0,null,function*(){global.isPhoneOpen=!1,l("PHONE","npwd:setVisibility",!1),yield p.closePhone(),SetNuiFocus(!1,!1),SetNuiFocusKeepInput(!1),emit("npwd:disableControlActions",!1)});RegisterCommand(E.general.toggleCommand,()=>o(void 0,null,function*(){global.isPhoneDisabled||(yield $e())}),!1);RegisterCommand("phone:restart",()=>o(void 0,null,function*(){yield b(),l("PHONE","phoneRestart",{})}),!1);Ye=()=>o(void 0,null,function*(){let t=yield Promise.resolve(We[E.PhoneAsItem.exportResource][E.PhoneAsItem.exportFunction]());if(typeof t!="number"&&typeof t!="boolean")throw new Error("You must return either a boolean or number from your export function");return!!t});onNet("npwd:sendCredentials",t=>{l("SIMCARD","npwd:setNumber",t)});on("onResourceStop",t=>{t===GetCurrentResourceName()&&(l("PHONE","npwd:setVisibility",!1),SetNuiFocus(!1,!1),p.endPhoneCall(),p.closePhone(),ClearPedTasks(PlayerPedId()))});m("npwd:close",(t,e)=>o(void 0,null,function*(){yield b(),e()}));m("npwd:toggleAllControls",(n,r)=>o(void 0,[n,r],function*({keepGameFocus:t},e){global.isPhoneOpen&&SetNuiFocusKeepInput(t),e({})}))});var ce=a(()=>{});var Ae=a(()=>{ce();I();d();i("npwd:getOrCreateTwitterProfile");i("npwd:deleteTweet");i("npwd:updateTwitterProfile");i("npwd:createTwitterProfile");i("npwd:fetchTweets");i("npwd:createTweet");i("npwd:fetchTweetsFiltered");i("npwd:toggleLike");i("npwd:reportTweet");i("npwd:retweet");onNet("createTweetBroadcast",t=>{se("createTweetBroadcast",t)})});var z=a(()=>{});var Ce=a(()=>{z();d();i("npwd:getContacts");i("npwd:addContacts");i("npwd:deleteContact");i("npwd:updateContact")});var _e=a(()=>{});var Se=a(()=>{_e();d();I();i("npwd:fetchAllListings");i("npwd:addListing");i("npwd:marketplaceDeleteListing");i("npwd:reportListing");onNet("npwd:sendMarketplaceBroadcastAdd",t=>{k("npwd:sendMarketplaceBroadcastAdd",t)});onNet("npwd:sendMarketplaceBroadcastDelete",t=>{k("npwd:sendMarketplaceBroadcastDelete",t)})});var J=a(()=>{});var ue=a(()=>{J();d();i("npwd:addNote");i("npwd:fetchAllNotes");i("npwd:updateNote");i("npwd:deleteNote")});var ge=a(()=>{});var Ie=re(R=>{ge();O();I();G();y();M();H();d();var fe=GetConvar("SCREENSHOT_BASIC_TOKEN","none"),je=global.exports,U=!1;function Xe(){SetNuiFocus(!1,!1),l("PHONE","npwd:setVisibility",!1)}function Ne(){SetNuiFocus(!0,!0),l("PHONE","npwd:setVisibility",!0)}function qe(t){return Citizen.invokeNative("0x2491A93618B7D838",t)}var Ze=()=>{BeginTextCommandDisplayHelp("THREESTRINGS"),AddTextComponentString("Exit Camera Mode: ~INPUT_CELLPHONE_CANCEL~"),AddTextComponentString("Toggle Front/Back: ~INPUT_PHONE~"),AddTextComponentString("Take Picture: ~INPUT_CELLPHONE_SELECT~"),EndTextCommandDisplayHelp(0,!0,!1,-1)};m("npwd:TakePhoto",(t,e)=>o(R,null,function*(){yield p.openCamera(),emit("npwd:disableControlActions",!1);let n=!1;for(CreateMobilePhone(1),CellCamActivate(!0,!0),Xe(),SetNuiFocus(!1,!1),U=!0,emit("npwd:PhotoModeStarted");U;){if(yield c(0),IsControlJustPressed(1,27))n=!n,qe(n);else if(IsControlJustPressed(1,176)){let r=yield Qe();e(r);break}else if(IsControlJustPressed(1,194)){yield et();break}Ze()}ClearHelp(!0),emit("npwd:PhotoModeEnded"),emit("npwd:disableControlActions",!0),yield p.closeCamera()}));var Qe=()=>o(R,null,function*(){ClearHelp(!0),yield c(0),setTimeout(()=>{DestroyMobilePhone(),CellCamActivate(!1,!1),Ne(),p.openPhone(),emit("npwd:disableControlActions",!0)},200);let t=yield tt();return U=!1,t}),et=()=>o(R,null,function*(){pe("npwd:cameraExited"),ClearHelp(!0),yield p.closeCamera(),emit("npwd:disableControlActions",!0),DestroyMobilePhone(),CellCamActivate(!1,!1),Ne(),U=!1}),tt=()=>new Promise((t,e)=>{if(fe==="none"&&E.images.useAuthorization)return console.error("Screenshot basic token not found. Please set in server.cfg");je["screenshot-basic"].requestScreenshotUpload(E.images.url,E.images.type,{encoding:E.images.imageEncoding,headers:{authorization:E.images.useAuthorization?`${E.images.authorizationPrefix} ${fe}`:void 0,"content-type":E.images.contentType}},n=>o(R,null,function*(){try{let r=JSON.parse(n);for(let A of E.images.returnedDataIndexes)r=r[A];let s=yield f.emitNetPromise("npwd:UploadPhoto",r);t(s)}catch(r){e(r.message)}}))});i("npwd:FetchPhotos");i("npwd:deletePhoto")});var De=a(()=>{});var Pe=a(()=>{De();I();d();i("npwd:fetchMessageGroups");i("npwd:deleteMessage");i("npwd:fetchMessages");i("npwd:createMessageGroup");i("nwpd:deleteConversation");i("npwd:sendMessage");onNet("npwd:sendMessageSuccess",t=>{F("npwd:sendMessageSuccess",t)});onNet("npwd:createMessagesBroadcast",t=>{F("npwd:createMessagesBroadcast",t)});onNet("npwd:createMessageConversationSuccess",t=>{F("npwd:createMessageConversationSuccess",t)})});var j=a(()=>{});var Oe,C,he=a(()=>{j();Oe=global.exports,C=class{constructor(){this.currentCall=0}static sendCallAction(e,n){SendNUIMessage({app:"CALL",method:e,data:n})}isInCall(){return this.currentCall!==0}openCallModal(e){C.sendCallAction("npwd:callModal",e)}handleRejectCall(){this.isInCall()||(this.openCallModal(!1),C.sendCallAction("npwd:setCaller",null))}handleStartCall(e,n,r,s){if(this.isInCall())return emitNet("npwd:rejectCall",e,1);this.openCallModal(!0),SendNUIMessage({app:"CALL",method:"npwd:setCaller",data:{active:!0,transmitter:e,receiver:n,isTransmitter:r,accepted:!1,isUnavailable:s}})}handleCallAccepted(e){this.currentCall=e.channelId,Oe["pma-voice"].setCallChannel(e.channelId),C.sendCallAction("npwd:setCaller",e)}handleEndCall(){this.currentCall=0,Oe["pma-voice"].setCallChannel(0),this.openCallModal(!1),C.sendCallAction("npwd:setCaller",null)}handleSendAlert(e){SendNUIMessage({app:"DIALER",method:"npwd:callSetAlert",data:e})}}});var X,q,Le=a(()=>{X=(t,e)=>onNet(t,e),q=(t,e,n)=>{if(n)return emitNet(t,n,e);emitNet(t,e)}});var _,Z,Q=a(()=>{j();he();H();Le();d();y();_=new C,Z=(t,e)=>o(void 0,null,function*(){if(!_.isInCall())try{let n=yield f.emitNetPromise("npwd:beginCall",t);if(p.startPhoneCall(),n.status!=="ok")return e(n);let{transmitter:r,isTransmitter:s,receiver:A,isUnavailable:D}=n.data;_.handleStartCall(r,A,s,D),e(n)}catch(n){console.error(n),e({status:"error",errorMsg:"CLIENT_TIMED_OUT"})}});m("npwd:beginCall",Z);X("npwd:startCall",t=>{let{transmitter:e,isTransmitter:n,receiver:r,isUnavailable:s}=t;_.handleStartCall(e,r,n,s)});m("npwd:acceptCall",(t,e)=>{p.startPhoneCall(),q("npwd:acceptCall",t),e({})});X("npwd:callAccepted",t=>{_.handleCallAccepted(t)});m("npwd:rejectCall",(t,e)=>{q("npwd:rejectCall",t),e({})});onNet("npwd:callRejected",()=>o(void 0,null,function*(){_.handleRejectCall(),p.endPhoneCall()}));m("npwd:endCall",(t,e)=>o(void 0,null,function*(){try{let n=yield f.emitNetPromise("npwd:endCall",t);if(n.status==="error")return console.error(n.errorMsg);_.handleEndCall(),e({})}catch(n){console.error(n),e({status:"error",errorMsg:"CLIENT_TIMED_OUT"})}p.endPhoneCall()}));onNet("npwd:callEnded",()=>{_.handleEndCall(),p.endPhoneCall()});i("npwd:fetchCalls");onNet("npwd:callSetAlert",t=>{_.handleSendAlert(t)})});var be=a(()=>{});var Re=a(()=>{be();d();i("phone:getMatchProfiles");i("phone:getMyProfile");i("phone:getMatches");i("phone:saveLikes");i("phone:createMyProfile");i("phone:updateMyProfile")});var xe=re(we=>{I();G();d();Q();z();J();$();var S=global.exports;S("openApp",t=>{g("openApp",t,["string"]),l("PHONE","npwd:openApp",t)});S("setPhoneVisible",t=>o(we,null,function*(){g("setPhoneVisible",t,["boolean","number"]);let e=global.isPhoneDisabled,n=global.isPhoneOpen;if(e&&!t&&n)return;!!t?yield Y():yield b()}));S("isPhoneVisible",()=>global.isPhoneOpen);S("setPhoneDisabled",t=>{g("setPhoneVisible",t,["boolean","number"]);let e=!!t;global.isPhoneDisabled=e});S("isPhoneDisabled",()=>global.isPhoneDisabled);S("startPhoneCall",t=>{g("startPhoneCall",t,["string"]),Z({receiverNumber:t})});S("fillNewContact",t=>{g("fillNewContact",t,["object"]),Ee("npwd:addContactExport",t)});S("fillNewNote",t=>{g("fillNewNOte",t,["object"]),le("npwd:addNoteExport",t)})});var ye=a(()=>{});var Me=a(()=>{d();ye();m("npwd:nuiSettingsUpdated",(t,e)=>{global.exports["pma-voice"].setCallVolume(t.callVolume),e({})})});var tr,ar,f,y=a(()=>{d();M();$();Ae();Ce();Se();ue();tr=ie(Ie());Pe();Q();Re();W();ar=ie(xe());Me();f=new x});y();})();
